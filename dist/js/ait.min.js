/*! astrox-imperium-tools v0.0.1 | (c) 2019  | MIT License | git+https://github.com/sharpshifter/ait.git */
!(function(e,a,t){var s={buttons:"bold,italic,underline,strike,code,spoiler,line,quote,|,img,video,link,|,bullist,numlist,|,fontcolor,fontsize,fontfamily,|,justifyleft,justifycenter,justifyright,|,removeFormat",allButtons:{spoiler:{title:"Insert spoiler",buttonText:"spoiler",transform:{'<div class="spoiler">{SELTEXT}</div>':"[spoiler]{SELTEXT}[/spoiler]"}},line:{title:"Insert horizontal rule/line",buttonText:"line",transform:{"{SELTEXT}<hr>":"{SELTEXT}[line]"}}},autoresize:!1,resize_maxheight:400};function r(e){return e=e.replace(/[^\s]+/g,(function(e){return e.replace(/^./,(function(e){return e.toUpperCase()}))}))}e.showNotification=function(e,t="add_alert",s="info"){a.notify({icon:t,message:e},{type:s,timer:2e3,placement:{from:"top",align:"center"}})};var n=a("#shipdataexporter_sourcedata"),i=a("#shipdataexporter_process"),o=a("#shipdataexporter_sourcelabels"),p=a("#shipdataexporter_template"),l=a("#shipdataexporter_labelsandtemplate"),u=(a("#shipdataexporter_usedefaulttemplatelabels"),a("#shipdataexporter_modewarning")),c=(a("#shipdataexporter_generateoutput"),a("#modal_shipdataexporter_output")),d=a("#shipdataexporter_outputarea"),h=a("#shipdataexporter_copytoclipboard");e.shipDataExporter={wysibbInBBCodeMode:!1,currentShipDataString:"",currentShipDataArray:[{}],shipInfoPattern:new RegExp(/SHIP_([^;]+);(.*)/g),init:function(){if(n.on("change keyup paste",(function(){n.val().length?i.removeClass("disabled"):i.addClass("disabled")})),h.length){var a=new ClipboardJS(h[0]);a.on("success",(function(a){e.showNotification("Successfully copied code to clipboard!","done","success")})),a.on("error",(function(a){e.showNotification("Unable to copy code to clipboard","error_outline","danger")}))}},startProcess:function(){if(e.shipDataExporter.currentShipDataString=n.val(),e.shipDataExporter.currentShipDataString.length)if(-1!==e.shipDataExporter.currentShipDataString.indexOf("SHIP_")){var t;for(e.shipDataExporter.currentShipDataArray=[];null!=(t=e.shipDataExporter.shipInfoPattern.exec(e.shipDataExporter.currentShipDataString));)e.shipDataExporter.currentShipDataArray.push(t);e.shipDataExporter.currentShipDataArray.length?(e.shipDataExporter.currentShipDataArray.sort(),o.empty(),o.append(u),a.each(e.shipDataExporter.currentShipDataArray,(function(e,a){var t='<span class="badge badge-light" data-itemtag="'+a[1]+'">'+(function(e){var a="",t=e.replace("_lifesupport","_life_support");t=(t=t.replace("ls_","life_support_")).split("_");for(var s=0;s<t.length;s++)a+=s>0?" "+r(t[s]):r(t[s]);return a})(a[1])+"</span> ";o.append(t)})),e.showNotification("Successfully processed ship data","done","success"),l.removeClass("d-none"),p.wysibb(s),a("html, body").animate({scrollTop:l.offset().top-20},350)):e.showNotification("Unable to process source ship data","error_outline","danger")}else e.showNotification("The source data doesn't seem to contain any ship stats","warning","warning")},insertTag:function(e,t){if(!o.find("#shipdataexporter_modewarning").is(":visible")){var s=a(t).data("itemtag");a(t).removeClass("badge-light").removeClass("badge-secondary").removeClass("badge-primary").removeClass("badge-success"),e.shiftKey?(p.insertAtCursor(p.val()+"{"+s+"|*name}"),a(t).addClass("badge-success")):e.altKey?(p.insertAtCursor(p.val()+"{"+s+"|*value}"),a(t).addClass("badge-primary")):(p.insertAtCursor(p.val()+"{"+s+"|*name}: {"+s+"|*value}"),a(t).addClass("badge-secondary"))}},doWysibbMode:function(a){e.shipDataExporter.wysibbInBBCodeMode=a,a?o.addClass("blurred").find("#shipdataexporter_modewarning").show():o.removeClass("blurred").find("#shipdataexporter_modewarning").hide()},useDefaultTemplate:function(){if(e.shipDataExporter.wysibbInBBCodeMode){var a="[b][size=3]{name|*value}[/size][/b]\n\n[img]https://via.placeholder.com/550x400.png?text=Ship+Image+Here[/img]\n\n[b][size=3]Primary Ship Details[/size][/b]\n{type|*name}: {type|*value}\n{class|*name}: {class|*value}\n{manufacturer|*name}: {manufacturer|*value}\n{active_slots|*name}: {active_slots|*value}\n{passive_slots|*name}: {passive_slots|*value}\n{base_price|*name}: {base_price|*value}\n\n[b][size=3]Base Attributes[/size][/b]\n{base_shield|*name}: {base_shield|*value}\n{base_energy|*name}: {base_energy|*value}\n{impact_resistance|*name}: {impact_resistance|*value}\n{energy_resistance|*name}: {energy_resistance|*value}\n{explosive_resistance|*name}: {explosive_resistance|*value}\n\n{base_engine_burn|*name}: {base_engine_burn|*value}\n{base_recharge|*name}: {base_recharge|*value}\n{base_turn|*name}: {base_turn|*value}\n{base_thrust|*name}: {base_thrust|*value}\n{base_mass|*name}: {base_mass|*value}\n\n{base_cargo|*name}: {base_cargo|*value}\n{base_lifesupport|*name}: {base_lifesupport|*value}\n\n{base_scan_speed|*name}: {base_scan_speed|*value}\n{base_scan_max_targets|*name}: {base_scan_max_targets|*value}\n{base_scan_pulserange|*name}: {base_scan_pulserange|*value}\n{base_scan_pulsespeed|*name}: {base_scan_pulsespeed|*value}\n";p.bbcode(a),p.val(a),p.sync()}else alert("Switch the editor to BBCode mode first")},generateOutput:function(){d.val(p.bbcode()),c.modal("show")}},a((function(){n.length&&e.shipDataExporter.init(),o.on("click","span.badge",(function(a){e.shipDataExporter.insertTag(a,this)}))}))})(window.ait=window.ait||{},jQuery);