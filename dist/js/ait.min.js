/*! astrox-imperium-tools v0.0.1 | (c) 2019  | MIT License | git+https://github.com/sharpshifter/ait.git */
!(function(t,e,a){function r(t){return t=t.replace(/[^\s]+/g,(function(t){return t.replace(/^./,(function(t){return t.toUpperCase()}))}))}t.showNotification=function(t,a="add_alert",r="info"){e.notify({icon:a,message:t},{type:r,timer:2e3,placement:{from:"top",align:"center"}})};var s=e("#shipdataexporter_sourcedata"),i=e("#shipdataexporter_process"),n=e("#shipdataexporter_sourcelabels"),o=e("#shipdataexporter_template"),p=e("#shipdataexporter_labelsandtemplate");e("#shipdataexporter_generateoutput");t.shipDataExporter={currentShipDataString:"",currentShipDataArray:[{}],shipInfoPattern:new RegExp(/SHIP_([^;]+);(.*)/g),init:function(){s.on("change keyup paste",(function(){s.val().length?i.removeClass("disabled"):i.addClass("disabled")}))},startProcess:function(){if(t.shipDataExporter.currentShipDataString=s.val(),t.shipDataExporter.currentShipDataString.length)if(-1!==t.shipDataExporter.currentShipDataString.indexOf("SHIP_")){var a;for(t.shipDataExporter.currentShipDataArray=[];null!=(a=t.shipDataExporter.shipInfoPattern.exec(t.shipDataExporter.currentShipDataString));)t.shipDataExporter.currentShipDataArray.push(a);if(t.shipDataExporter.currentShipDataArray.length){t.shipDataExporter.currentShipDataArray.sort(),n.empty(),e.each(t.shipDataExporter.currentShipDataArray,(function(t,e){var a='<span class="badge badge-light" data-itemtag="'+e[1]+'">'+(function(t){var e="",a=t.replace("_lifesupport","_life_support");a=(a=a.replace("ls_","life_support_")).split("_");for(var s=0;s<a.length;s++)e+=s>0?" "+r(a[s]):r(a[s]);return e})(e[1])+"</span> ";n.append(a)})),t.showNotification("Successfully processed ship data","done","success"),p.removeClass("d-none");e("#shipdataexporter_template").wysibb({buttons:"bold,italic,underline,strike,code,spoiler,quote,|,img,video,link,|,bullist,numlist,|,fontcolor,fontsize,fontfamily,|,justifyleft,justifycenter,justifyright,|,removeFormat",allButtons:{spoiler:{title:"Insert spoiler",buttonText:"spoiler",transform:{'<div class="spoiler">{SELTEXT}</div>':"[spoiler]{SELTEXT}[/spoiler]"}}}}),e("html, body").animate({scrollTop:p.offset().top-20},350)}else t.showNotification("Unable to process source ship data","error_outline","danger")}else t.showNotification("The source data doesn't seem to contain any ship stats","warning","warning")},insertTag:function(t,a){var r=e(a).data("itemtag");e(a).removeClass("badge-light").removeClass("badge-secondary").removeClass("badge-primary").removeClass("badge-success"),t.shiftKey?(o.insertAtCursor(o.val()+"{"+r+"|*name}"),e(a).addClass("badge-success")):t.altKey?(o.insertAtCursor(o.val()+"{"+r+"|*value}"),e(a).addClass("badge-primary")):(o.insertAtCursor(o.val()+"{"+r+"|*name}: {"+r+"|*value}"),e(a).addClass("badge-secondary"))},generateOutput:function(){console.log("Generate Output")}},e((function(){s.length&&t.shipDataExporter.init(),n.on("click","span.badge",(function(e){t.shipDataExporter.insertTag(e,this)}))}))})(window.ait=window.ait||{},jQuery);